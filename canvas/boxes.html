<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Boxes</title>
  <meta name="viewport" content="width=device-width" />
  <style>
    html, body {
      height: 100vh;
    }
    canvas {
      border: 1px solid black;
    }
  </style>
</head>
<body>
  <h1>Boxes</h1>
  <canvas id="canvas"></canvas>
  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    canvas.setAttribute('width', '480');
    canvas.setAttribute('height', '120');

    // Takes effect after canvas.setAttribute
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.font = '18px Roboto, Arial';

    const cells = [{
      num: 23,
      cellStyle: 'INIT'
    }, {
      num: 34,
      cellStyle: 'MARKED'
    }, {
      num: 45,
      cellStyle: 'ONE_LEFT'
    }, {
      num: 55,
      cellStyle: 'ONE_LEFT'
    }];

    function drawRoundedRect({
      x,
      y,
      width,
      height,
      radius = 2,
      glowOffset = 0,
      glowRBG = [],
      dashed = false,
      clipped = false,
    }) {
      ctx.beginPath();
      ctx.moveTo(x + radius, y);
      ctx.lineTo(x + width - radius, y);
      ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
      ctx.lineTo(x + width, y + height - radius);
      ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
      ctx.lineTo(x + radius, y + height);
      ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
      ctx.lineTo(x, y + radius);
      ctx.quadraticCurveTo(x, y, x + radius, y);
      ctx.closePath();

      ctx.setLineDash(dashed ? [4, 4] : []);

      if (clipped) return ctx.clip();

      ctx.fill();

      if (glowOffset && glowRBG.length) {
        ctx.save();
        ctx.clip();

        const startRGBA = `rgba(${glowRBG[0]}, ${glowRBG[1]}, ${glowRBG[2]}, 0.50)`;
        const endRGBA = `rgba(${glowRBG[0]}, ${glowRBG[1]}, ${glowRBG[2]}, 0)`;
        const rightGlow = ctx.createLinearGradient(
          x + width, y, x + width - glowOffset, y
        );
        rightGlow.addColorStop(0, startRGBA);
        rightGlow.addColorStop(1, endRGBA);
        ctx.fillStyle = rightGlow;
        ctx.fillRect(x + width - glowOffset * 2, y, glowOffset * 2, height);
  
        const bottomGlow = ctx.createLinearGradient(
          x, y + height, x, y + height - glowOffset
        );
        bottomGlow.addColorStop(0, startRGBA);
        bottomGlow.addColorStop(1, endRGBA);
        ctx.fillStyle = bottomGlow;
        ctx.fillRect(x, y + height - glowOffset * 2, width, glowOffset * 2);

        ctx.restore();
      }

      ctx.stroke();
    }

    function drawRectangles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear canvas before redrawing

      cells.forEach(cell => {
        switch (cell.cellStyle) {
          case 'MARKED':
            ctx.fillStyle = "#FFAC43";
            ctx.strokeStyle = "#EA8C15";
            drawRoundedRect({ x: 50, y: 10, width: 30, height: 30, radius: 6, dashed: false });
            ctx.fillStyle = "#933807";
            ctx.fillText(34, 50 + 30 / 2, 1 + 10 + 30 / 2);
            break;

          case 'ONE_LEFT':
            ctx.fillStyle = "#FFFFFF";
            ctx.strokeStyle = "#FFAC43";
            drawRoundedRect({
              x: 130,
              y: 10,
              width: 30,
              height: 30,
              radius: 6,
              glowOffset: 7,
              glowRBG: [255, 172, 67],
              dashed: false,
            });

            ctx.fillStyle = "#FF5900";
            ctx.fillText(56, 130 + 30 / 2, 1 + 10 + 30 / 2);
            break;

          default:
            ctx.fillStyle = "rgba(131, 158, 230, 0.5)";
            ctx.strokeStyle = "#839EE6";
            drawRoundedRect({
              x: 10,
              y: 10,
              width: 30,
              height: 30,
              radius: 6,
              dashed: true,
            });
            ctx.fillStyle = "#2B4995";
            ctx.fillText(23, 10 + 30 / 2, 1 + 10 + 30 / 2);
        }
      });
    }

    drawRectangles(); // Initial draw
  </script>
</body>
</html>
